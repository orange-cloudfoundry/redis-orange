---
name: redis_check

templates:
  bin/run.erb: bin/run
  keys/cli.crt.erb: keys/cli.crt
  keys/cli.key.erb: keys/cli.key
  keys/ca.crt.erb: keys/ca.crt

packages:
- redis

consumes:
- name: redis_conn
  type: conn
- name: slave_conn
  type: conn
  optional: true
- name: redis_sentinel_conn
  type: sentinel_conn
  optional: true
- name: sentinel_slave_conn
  type: sentinel_conn
  optional: true

properties:
################################# TLS/SSL #####################################
  tls_keys:
    description: |
      Certificate materials for TLS connection.
    type: certificate
  tls_keys_dir:
    default: "/var/vcap/jobs/redis_check/keys"
    description: |
      The directory where TLS keys are stored.
  tls_ca_cert_file:
    default: "ca.crt"
    description: |
      Configure a CA certificate(s) bundle or directory to authenticate TLS/SSL clients and peers. Redis requires an explicit configuration of at least one of these, and will not implicitly use the system wide configuration.
  tls_cert_file:
    default: "cli.crt"
    description: |
      Configure a X.509 certificate and private key to use for authenticating the server to connected clients, masters or cluster peers. These files should be PEM formatted.
  tls_key_file:
    default: "cli.key"
    description: |
      See tls_cert_file.
